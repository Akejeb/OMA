---
title: ""
output: html_notebook
---

# Visualization

```{r setup, echo=FALSE, results="asis"}
#library(rebook)
#chapterPreamble()
```

Whether a data set contains information on a microbial community or it originates from a different source, the way that data are visualized inevitably shapes how they will be interpreted, and motivates the next steps of the analysis.

A large variety of graphing methods belong to microbial analysis, but only few are the choices that will return useful answers about the data. Therefore, knowledge on the available tools and their possible applications plays an important role in selecting the most suitable method for the asked question.

This chapter introduces the reader to a number of visualization techniques found in this book, such as:

* bar plots
* box plots
* heat maps
* ordination charts
* regression charts
* tree charts

The toolkit which provides the essential plotting functionality includes the following packages:

* `patchwork`, `cowplot`, `ggpubr` and `gridExtra`: plot layout and multi-panel plotting
* `miaViz`: specific visualization tools for `TreeSummaizedExperiment` objects
* `scater`: specific visualization tools for `SingleCellExperiment` objects
* `ggplot2`, `pheatmap`, `ggtree` and `sechm`: composition heat maps
* `ANCOMBC`, `ALDEx2` and `map2`: visual differential abundance
* `fido` and `pibble`: tree-based methods for differential abundance
* `plotly`: animated and 3D plotting

For systematic and extensive tutorials on the visual tools available in `phyloseq` and `mia`, readers can refer to the following material:

* [phyloseq tutorials](http://joey711.github.io/phyloseq/tutorials-index)
* [microbiome tutorials](https://microbiome.github.io/tutorials/)

```{r, include = FALSE}
theme_set(theme_classic())
library(mia)
library(ggplot2)
library(scater)
data("GlobalPatterns", package = "mia")
tse <- GlobalPatterns
```

## Accessing row and column data

`SCE` and `TSE` objects contain multiple layers of information in the form of rows, columns and meta data. The `scater` package supports in accessing and visualizing the meta data related to features as well as samples.





```{r}
ggplot(coldata, aes(x = SampleType)) +
  geom_bar(width = 0.5) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(x = "Sampling Site",
       y = "Number of Samples")
  
```

```{r}
plotColData(tse,"sum","X.SampleID", colour_by = "SampleType") + 
    theme(axis.text.x = element_text(angle = 45, hjust=1)) +
    labs(y = "Library size (N)", x = "Sample ID")       
```


## Session Info {-}

```{r sessionInfo, echo=FALSE, results='asis'}
#prettySessionInfo()
```